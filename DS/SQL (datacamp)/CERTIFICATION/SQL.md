# TASK 1
```
-- Write your query for task 1 in this cell
WITH CLEANED_FIRST_3 AS(
SELECT ID,
CASE
	WHEN LOCATION IS NULL THEN 'Unknown'
	WHEN LOCATION NOT IN ('EMEA', 'NA', 'LATAM', 'APAC') THEN 'Unknown'
	ELSE LOCATION
END AS LOCATION,
CASE 
	WHEN TOTAL_ROOMS IS NULL THEN 100
	WHEN TOTAL_ROOMS > 400 THEN 100
	WHEN TOTAL_ROOMS < 1 THEN 100
ELSE TOTAL_ROOMS
END AS TOTAL_ROOMS,
CASE 
	WHEN STAFF_COUNT IS NULL THEN ROUND(TOTAL_ROOMS * 1.5)
	ELSE STAFF_COUNT
END AS STAFF_COUNT,
OPENING_DATE,
TARGET_GUESTS
FROM BRANCH
),
	
CLEANED_ALL AS(
SELECT 
    ID,
    LOCATION,
    TOTAL_ROOMS,
    STAFF_COUNT,
    CASE
        WHEN OPENING_DATE = '-' THEN 2023                 
        WHEN CAST(OPENING_DATE AS INT) IS NULL THEN 2023  
        WHEN CAST(OPENING_DATE AS INT) > 2023 THEN 2023 
        WHEN CAST(OPENING_DATE AS INT) < 2000 THEN 2023
        ELSE CAST(OPENING_DATE AS INT)
    END AS OPENING_DATE,
    CASE 
        WHEN TARGET_GUESTS IS NULL THEN 'Leisure'
	    WHEN TARGET_GUESTS LIKE '%B.%' THEN 'Business'
        ELSE TARGET_GUESTS
    END AS TARGET_GUESTS
FROM CLEANED_FIRST_3
)
	
SELECT 
	ID,
	LOCATION,
	TOTAL_ROOMS,
	STAFF_COUNT,
	OPENING_DATE,
	TARGET_GUESTS
FROM CLEANED_ALL

```
# TASK 2
```
-- Write your query for task 2 in this cell
SELECT R.SERVICE_ID,
	R.BRANCH_ID,
	ROUND(AVG(R.TIME_TAKEN), 2) AS avg_time_taken,
	MAX(R.TIME_TAKEN) AS max_time_taken
FROM REQUEST AS R
LEFT JOIN BRANCH AS B
ON R.BRANCH_ID = B.ID
GROUP BY R.SERVICE_ID, R.BRANCH_ID
```
# TASK 3
```
-- Write your query for task 3 in this cell
SELECT
	S.DESCRIPTION,
	B.ID,
	B.LOCATION,
	R.ID AS request_id,
	R.RATING
FROM REQUEST AS R
INNER JOIN SERVICE AS S
ON R.SERVICE_ID = S.ID  
INNER JOIN BRANCH AS B
ON R.BRANCH_ID = B.ID
WHERE S.DESCRIPTION IN ('Meal', 'Laundry') AND B.LOCATION IN ('EMEA', 'LATAM')
```

# TASK 4
```
-- Write your query for task 4 in this cell
SELECT
R.SERVICE_ID,
R.BRANCH_ID,
ROUND(AVG(R.RATING), 2) AS avg_rating
FROM REQUEST AS R
LEFT JOIN BRANCH AS B
ON R.BRANCH_ID = B.ID
GROUP BY R.SERVICE_ID, R.BRANCH_ID
HAVING AVG(R.RATING) < 4.5
```